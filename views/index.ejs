<%- include('partials/header') %>

  <main class="flex-fill">
    <div class="container py-4">
      <!-- Header Section -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h2 class="fw-bold mb-1 text-success">Welcome to EMPLOYEE Dashboard </h2>
          <p class="text-muted">Welcome back! Here's what's happening today.</p>
        </div>
        <button class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#employeeModal">
          <i class="bi bi-plus-lg me-1"></i> Add Employee
        </button>
      </div>





      <!-- Recent Tasks and Quick Actions -->
      <div class="row g-4 ">
        <div class="col-lg-8">
          <div class="card border-0 h-100 p-3" style="   box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;">
            <div class="card-header bg-white border-0 d-flex justify-content-between align-items-center">
              <h5 class="mb-0">Recent Tasks</h5>
              <a href="/taskManagement" class="btn btn-sm btn-outline-success">View All</a>
            </div>
            <div class="card-body">
              <% if (tasks.length> 0) { %>
                <div class="list-group list-group-flush">
                  <% tasks.slice(0, 4).forEach(task=> { %>
                    <div class="list-group-item border-0 px-0 py-3">
                      <div class="d-flex justify-content-between align-items-center mb-1">
                        <h6 class="mb-0">
                          <%= task.subject %>
                        </h6>
                        <span
                          class="badge bg-<%= task.priority === 'High' ? 'danger' : task.priority === 'Medium' ? 'warning' : 'success' %> bg-opacity-10 text-<%= task.priority === 'High' ? 'danger' : task.priority === 'Medium' ? 'warning' : 'success' %>">
                          <%= task.priority %>
                        </span>
                      </div>
                      <p class="text-muted small mb-2">
                        <%= task.project %>
                      </p>
                      <div class="d-flex justify-content-between align-items-center">
                        <span class="text-muted small"><i class="bi bi-person me-1"></i>
                          <%= task.employeeName %>
                        </span>
                        <span class="text-muted small"><i class="bi bi-calendar me-1"></i> Due: <%= task.deadline %>
                            </span>
                      </div>
                    </div>
                    <% }) %>
                </div>
                <% } else { %>
                  <div class="text-center py-4">
                    <i class="bi bi-clipboard-x text-muted fs-1"></i>
                    <p class="text-muted mt-2">No tasks assigned yet</p>
                  </div>
                  <% } %>
            </div>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="card border-0 h-100" style="   box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;">
            <div class="card-header bg-white border-0 p-3">
              <h5 class="mb-0">Quick Actions</h5>
            </div>
            <div class="card-body">
              <div class="d-grid gap-2">
                <a href="/employee" class="btn btn-outline-primary text-start">
                  <i class="bi bi-people-fill me-2"></i> Manage Employees
                </a>
                <a href="/taskManagement" class="btn btn-outline-success text-start">
                  <i class="bi bi-clipboard-plus me-2"></i> Task
                </a>
                <button class="btn btn-outline-warning text-start" data-bs-toggle="modal" data-bs-target="#employeeModal">
                  <i class="bi bi-person-plus me-2"></i> Add Employee
                </button>

              </div>

              <hr class="my-4">

              <h6 class="mb-3">Recent Activity</h6>
              <div class="list-group list-group-flush">
                <% if (employees.length> 0) { %>
                  <div class="list-group-item border-0 px-0 py-2">
                    <div class="d-flex align-items-center">
                      <div class="flex-shrink-0">
                        <i class="bi bi-person-plus text-success"></i>
                      </div>
                      <div class="flex-grow-1 ms-3">
                        <p class="mb-0 small">New employee added: <%= employees[employees.length-1].name %>
                        </p>
                      </div>
                    </div>
                    <% } %>
                      <% if (tasks.length> 0) { %>
                        <div class="list-group-item border-0 px-0 py-2">
                          <div class="d-flex align-items-center">
                            <div class="flex-shrink-0">
                              <i class="bi bi-clipboard-plus text-primary"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                              <p class="mb-0 small">Task assigned: <%= tasks[tasks.length-1].subject %>
                              </p>
                            </div>
                          </div>
                        </div>
                        <% } %>
                  </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Employee Modal -->
      <div class="modal fade" id="employeeModal" tabindex="-1" aria-labelledby="employeeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
          <div class="modal-content border-0 shadow-lg">
            <form action="/add-employee" method="POST">
              <div class="modal-header bg-success text-white">
                <h5 class="modal-title fw-bold" id="employeeModalLabel">
                  <i class="bi bi-person-plus me-2"></i> Add New Employee
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                  aria-label="Close"></button>
              </div>

              <div class="modal-body p-4">
                <div class="row g-3">
                  <div class="col-md-6">
                    <div class="form-floating">
                      <input type="text" name="id" class="form-control" id="employeeId" placeholder="Employee ID"
                        required>
                      <label for="employeeId">Employee ID</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <input type="text" name="name" class="form-control" id="employeeName" placeholder="Full Name"
                        required>
                      <label for="employeeName">Full Name</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <input type="number" name="balance" class="form-control" id="employeeBalance"
                        placeholder="Balance" required>
                      <label for="employeeBalance">Balance (â‚¹)</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <select name="level" class="form-select" id="employeeLevel" required>
                        <option value="" disabled selected>Select level</option>
                        <option value="JUNIOR">Junior</option>
                        <option value="MIDDLE">Middle</option>
                        <option value="SENIOR">Senior</option>
                      </select>
                      <label for="employeeLevel">Level</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <select name="role" class="form-select" id="employeeRole" required>
                        <option selected disabled>Select Position</option>
                        <option value="UI Designer">CEO</option>
                        <option value="Full-Stack Developer">Board of Directors</option>
                        <option value="Frontend Developer">Manager</option>
                        <option value="Backend Developer">HR</option>
                        <option value="Full-Stack Developer">Team Leader</option>
                      </select>
                      <label for="employeeRole">Position</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                     <input type="department" name="department" class="form-control" id="addEmployeeDepartment" placeholder="Department"
                        required>
                      <label for="employeeDepartment">Department</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <input type="email" name="email" class="form-control" id="employeeEmail" placeholder="Email"
                        required>
                      <label for="employeeEmail">Email</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <input type="text" name="phone" class="form-control" id="employeePhone" placeholder="Phone"
                        pattern="[0-9]{10}" required>
                      <label for="employeePhone">Phone</label>
                    </div>
                  </div>
                </div>
              </div>

              <div class="modal-footer border-top-0 bg-light">
                <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                  <i class="bi bi-x-circle me-1"></i> Cancel
                </button>
                <button type="submit" class="btn btn-success">
                  <i class="bi bi-check-circle me-1"></i> Save Employee
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>


      <!-- Recent Employees Table -->
     
      <div class="card border-0  mb-4 mt-5" style="box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;">
        <div class="card-header bg-white border-0 d-flex justify-content-between align-items-center">
          <h5 class="mb-0">Employee Information</h5>

        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped mb-0">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Name</th>
                  <th>Department</th>
                  <th>Position</th>
                  <th>Status</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                <% employees.slice(0, 5).forEach(emp=> { %>
                  <tr>
                    <td>
                      <%= emp.id %>
                    </td>
                    <td>
                      <div class="d-flex align-items-center">

                        <%= emp.name %>
                      </div>
                    </td>
                    <td>
                      <%= emp.department %>
                    </td>
                    <td>
                      <%= emp.role %>
                    </td>
                    <td>
                      <span class="badge bg-success bg-opacity-10 text-success">Active</span>
                    </td>
                    <td>
                      <a href="/employee" class="btn btn-sm btn-outline-secondary">View</a>
                    </td>
                  </tr>
                  <% }) %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
  </main>

  <%- include('partials/footer') %>